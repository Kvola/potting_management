<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- Daily Report Email Template (Per OT) -->
        <record id="mail_template_potting_daily_report" model="mail.template">
            <field name="name">Rapport journalier d'empotage</field>
            <field name="model_id" ref="potting_management.model_potting_transit_order"/>
            <field name="subject">üìä Rapport OT ${object.name} - ${object.customer_id.name} | ${format_date(env, context_timestamp(datetime.datetime.now()), date_format='dd/MM/yyyy')}</field>
            <field name="email_from">${(object.company_id.email or user.email_formatted) | safe}</field>
            <field name="email_to">${ctx.get('recipient_email', '')}</field>
            <field name="email_cc">${ctx.get('cc_emails', '')}</field>
            <field name="body_html" type="html">
<div style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f4;">
    <table width="100%" cellspacing="0" cellpadding="0" style="max-width: 800px; margin: 0 auto; background-color: #ffffff;">
        <!-- En-t√™te avec logo et titre -->
        <tr>
            <td style="background: linear-gradient(135deg, #1a5f2a 0%, #2d8b47 100%); padding: 25px 30px;">
                <table width="100%" cellspacing="0" cellpadding="0">
                    <tr>
                        <td style="vertical-align: middle;">
                            <span style="color: #90EE90; font-size: 24px; font-weight: bold;">IVORY</span><br/>
                            <span style="color: #D2691E; font-size: 24px; font-weight: bold;">COCOA</span>
                            <span style="color: #ffffff; font-size: 24px; font-weight: bold;">PRODUCTS</span><br/>
                            <span style="color: #ffffff; font-size: 12px;">C√¥te d'Ivoire</span>
                        </td>
                        <td style="text-align: right; vertical-align: middle;">
                            <span style="color: #ffffff; font-size: 22px; font-weight: bold;">üìä RAPPORT D'EMPOTAGE</span><br/>
                            <span style="color: #ffffff; font-size: 14px;">Ordre de Transit: <strong>${object.name}</strong></span>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        
        <!-- Bande de statut -->
        <tr>
            <td style="background-color: ${object.progress_percentage >= 100 and '#27ae60' or (object.progress_percentage >= 50 and '#f39c12' or '#e74c3c')}; padding: 12px 30px; text-align: center;">
                <span style="color: #ffffff; font-size: 16px; font-weight: bold;">
                    ${object.progress_percentage >= 100 and '‚úÖ PRODUCTION TERMIN√âE' or (object.progress_percentage >= 50 and 'üîÑ EN COURS DE PRODUCTION' or 'üöÄ D√âMARRAGE PRODUCTION')}
                    - Progression: ${round(object.progress_percentage, 1)}%
                </span>
            </td>
        </tr>
        
        <!-- Corps principal -->
        <tr>
            <td style="padding: 30px;">
                <!-- Salutation -->
                <p style="margin: 0 0 20px 0; color: #333333; font-size: 15px;">
                    Bonjour,
                </p>
                <p style="margin: 0 0 25px 0; color: #333333; font-size: 15px;">
                    Veuillez trouver ci-dessous le rapport d'empotage pour l'Ordre de Transit <strong style="color: #1a5f2a;">${object.name}</strong>.
                </p>
                
                <!-- Tableau informations principales -->
                <table width="100%" cellspacing="0" cellpadding="0" style="margin-bottom: 25px; border-collapse: collapse;">
                    <tr>
                        <td style="width: 50%; vertical-align: top; padding-right: 15px;">
                            <table width="100%" cellspacing="0" cellpadding="8" style="background-color: #f8f9fa; border-radius: 8px;">
                                <tr><td colspan="2" style="background-color: #1a5f2a; color: #ffffff; font-weight: bold; border-radius: 8px 8px 0 0; padding: 10px;">üìã INFORMATIONS CLIENT</td></tr>
                                <tr><td style="color: #666666; width: 40%;">Client:</td><td style="color: #333333; font-weight: 600;">${object.customer_id.name}</td></tr>
                                <tr style="background-color: #ffffff;"><td style="color: #666666;">Destinataire:</td><td style="color: #333333; font-weight: 600;">${object.consignee_id.name or '-'}</td></tr>
                                <tr><td style="color: #666666;">Produit:</td><td style="color: #333333; font-weight: 600;">${dict(object._fields['product_type'].selection).get(object.product_type, '')}</td></tr>
                                <tr style="background-color: #ffffff;"><td style="color: #666666;">Destination:</td><td style="color: #333333; font-weight: 600;">${object.pod or '-'}</td></tr>
                            </table>
                        </td>
                        <td style="width: 50%; vertical-align: top; padding-left: 15px;">
                            <table width="100%" cellspacing="0" cellpadding="8" style="background-color: #f8f9fa; border-radius: 8px;">
                                <tr><td colspan="2" style="background-color: #D2691E; color: #ffffff; font-weight: bold; border-radius: 8px 8px 0 0; padding: 10px;">üì¶ D√âTAILS LOGISTIQUES</td></tr>
                                <tr><td style="color: #666666; width: 40%;">Navire:</td><td style="color: #333333; font-weight: 600;">${object.vessel_name or '-'}</td></tr>
                                <tr style="background-color: #ffffff;"><td style="color: #666666;">N¬∞ Booking:</td><td style="color: #333333; font-weight: 600;">${object.booking_number or '-'}</td></tr>
                                <tr><td style="color: #666666;">Conteneur:</td><td style="color: #333333; font-weight: 600;">${object.container_size}'</td></tr>
                                <tr style="background-color: #ffffff;"><td style="color: #666666;">Date cr√©ation:</td><td style="color: #333333; font-weight: 600;">${format_date(env, object.date_created, date_format='dd/MM/yyyy')}</td></tr>
                            </table>
                        </td>
                    </tr>
                </table>
                
                <!-- Statistiques de production -->
                <table width="100%" cellspacing="0" cellpadding="0" style="margin-bottom: 25px;">
                    <tr>
                        <td style="width: 25%; text-align: center; padding: 15px; background-color: #e8f5e9; border-radius: 8px; margin: 5px;">
                            <span style="font-size: 28px; font-weight: bold; color: #1a5f2a;">${object.tonnage}</span><br/>
                            <span style="font-size: 12px; color: #666666;">TONNAGE (T)</span>
                        </td>
                        <td style="width: 5%;"></td>
                        <td style="width: 25%; text-align: center; padding: 15px; background-color: #fff3e0; border-radius: 8px; margin: 5px;">
                            <span style="font-size: 28px; font-weight: bold; color: #D2691E;">${round(object.progress_percentage, 1)}%</span><br/>
                            <span style="font-size: 12px; color: #666666;">PROGRESSION</span>
                        </td>
                        <td style="width: 5%;"></td>
                        <td style="width: 20%; text-align: center; padding: 15px; background-color: #e3f2fd; border-radius: 8px; margin: 5px;">
                            <span style="font-size: 28px; font-weight: bold; color: #1976d2;">${object.potted_lot_count}</span>/<span style="font-size: 18px; color: #666666;">${object.lot_count}</span><br/>
                            <span style="font-size: 12px; color: #666666;">LOTS EMPOT√âS</span>
                        </td>
                        <td style="width: 5%;"></td>
                        <td style="width: 20%; text-align: center; padding: 15px; background-color: #fce4ec; border-radius: 8px; margin: 5px;">
                            <span style="font-size: 28px; font-weight: bold; color: #c2185b;">${object.current_tonnage}</span><br/>
                            <span style="font-size: 12px; color: #666666;">TONNAGE ACTUEL (T)</span>
                        </td>
                    </tr>
                </table>
                
                <!-- Barre de progression visuelle -->
                <div style="margin-bottom: 25px;">
                    <div style="background-color: #e0e0e0; border-radius: 10px; height: 20px; overflow: hidden;">
                        <div style="background: linear-gradient(90deg, #27ae60, #2ecc71); height: 100%; width: ${min(object.progress_percentage, 100)}%; border-radius: 10px;"></div>
                    </div>
                </div>
                
                <!-- Message personnalis√© si pr√©sent -->
                % if ctx.get('custom_note'):
                <div style="background-color: #fff8e1; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 25px; border-radius: 0 8px 8px 0;">
                    <strong style="color: #f57c00;">üìù Note:</strong><br/>
                    <span style="color: #333333;">${ctx.get('custom_note')}</span>
                </div>
                % endif
                
                <!-- Signature -->
                <p style="margin: 30px 0 0 0; color: #333333; font-size: 15px;">
                    Cordialement,
                </p>
                <p style="margin: 5px 0 0 0; color: #1a5f2a; font-size: 15px; font-weight: bold;">
                    ${user.name}<br/>
                    <span style="font-size: 13px; font-weight: normal; color: #666666;">${user.email}</span>
                </p>
            </td>
        </tr>
        
        <!-- Pied de page -->
        <tr>
            <td style="background-color: #333333; padding: 20px 30px; text-align: center;">
                <span style="color: #ffffff; font-size: 12px;">
                    IVORY COCOA PRODUCTS - C√¥te d'Ivoire<br/>
                    <span style="color: #888888;">Ce rapport a √©t√© g√©n√©r√© automatiquement le ${format_datetime(env, context_timestamp(datetime.datetime.now()), dt_format='dd/MM/yyyy √† HH:mm')}</span>
                </span>
            </td>
        </tr>
    </table>
</div>
            </field>
            <field name="lang">${object.customer_id.lang}</field>
            <field name="auto_delete" eval="True"/>
        </record>

        <!-- Summary Report Email Template -->
        <record id="mail_template_potting_summary_report" model="mail.template">
            <field name="name">Rapport de synth√®se empotage</field>
            <field name="model_id" ref="potting_management.model_potting_customer_order"/>
            <field name="subject">üìä Synth√®se Commande ${object.name} - ${object.customer_id.name} | ${format_date(env, context_timestamp(datetime.datetime.now()), date_format='dd/MM/yyyy')}</field>
            <field name="email_from">${(object.company_id.email or user.email_formatted) | safe}</field>
            <field name="email_to">${ctx.get('recipient_email', '')}</field>
            <field name="email_cc">${ctx.get('cc_emails', '')}</field>
            <field name="body_html" type="html">
<div style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f4;">
    <table width="100%" cellspacing="0" cellpadding="0" style="max-width: 800px; margin: 0 auto; background-color: #ffffff;">
        <!-- En-t√™te -->
        <tr>
            <td style="background: linear-gradient(135deg, #1a5f2a 0%, #2d8b47 100%); padding: 25px 30px;">
                <table width="100%" cellspacing="0" cellpadding="0">
                    <tr>
                        <td style="vertical-align: middle;">
                            <span style="color: #90EE90; font-size: 24px; font-weight: bold;">IVORY</span><br/>
                            <span style="color: #D2691E; font-size: 24px; font-weight: bold;">COCOA</span>
                            <span style="color: #ffffff; font-size: 24px; font-weight: bold;">PRODUCTS</span><br/>
                            <span style="color: #ffffff; font-size: 12px;">C√¥te d'Ivoire</span>
                        </td>
                        <td style="text-align: right; vertical-align: middle;">
                            <span style="color: #ffffff; font-size: 22px; font-weight: bold;">üìä RAPPORT DE SYNTH√àSE</span><br/>
                            <span style="color: #ffffff; font-size: 14px;">Commande: <strong>${object.name}</strong></span>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        
        <!-- Corps -->
        <tr>
            <td style="padding: 30px;">
                <p style="margin: 0 0 20px 0; color: #333333; font-size: 15px;">Bonjour,</p>
                <p style="margin: 0 0 25px 0; color: #333333; font-size: 15px;">
                    Veuillez trouver ci-dessous le rapport de synth√®se pour la commande <strong style="color: #1a5f2a;">${object.name}</strong>.
                </p>
                
                <!-- Informations principales -->
                <table width="100%" cellspacing="0" cellpadding="8" style="background-color: #f8f9fa; border-radius: 8px; margin-bottom: 25px;">
                    <tr><td colspan="4" style="background-color: #1a5f2a; color: #ffffff; font-weight: bold; border-radius: 8px 8px 0 0; padding: 12px;">üìã D√âTAILS DE LA COMMANDE</td></tr>
                    <tr>
                        <td style="color: #666666; width: 20%;">Client:</td>
                        <td style="color: #333333; font-weight: 600; width: 30%;">${object.customer_id.name}</td>
                        <td style="color: #666666; width: 20%;">Date commande:</td>
                        <td style="color: #333333; font-weight: 600; width: 30%;">${format_date(env, object.date_order, date_format='dd/MM/yyyy')}</td>
                    </tr>
                    <tr style="background-color: #ffffff;">
                        <td style="color: #666666;">Nombre d'OT:</td>
                        <td style="color: #333333; font-weight: 600;">${object.transit_order_count}</td>
                        <td style="color: #666666;">Tonnage total:</td>
                        <td style="color: #333333; font-weight: 600;">${object.total_tonnage} T</td>
                    </tr>
                    <tr>
                        <td style="color: #666666;">√âtat:</td>
                        <td style="color: #333333; font-weight: 600;">${dict(object._fields['state'].selection).get(object.state, '')}</td>
                        <td style="color: #666666;">Responsable:</td>
                        <td style="color: #333333; font-weight: 600;">${object.user_id.name or '-'}</td>
                    </tr>
                </table>
                
                % if ctx.get('custom_note'):
                <div style="background-color: #fff8e1; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 25px; border-radius: 0 8px 8px 0;">
                    <strong style="color: #f57c00;">üìù Note:</strong><br/>
                    <span style="color: #333333;">${ctx.get('custom_note')}</span>
                </div>
                % endif
                
                <p style="margin: 30px 0 0 0; color: #333333; font-size: 15px;">Cordialement,</p>
                <p style="margin: 5px 0 0 0; color: #1a5f2a; font-size: 15px; font-weight: bold;">
                    ${user.name}<br/>
                    <span style="font-size: 13px; font-weight: normal; color: #666666;">${user.email}</span>
                </p>
            </td>
        </tr>
        
        <!-- Pied de page -->
        <tr>
            <td style="background-color: #333333; padding: 20px 30px; text-align: center;">
                <span style="color: #ffffff; font-size: 12px;">
                    IVORY COCOA PRODUCTS - C√¥te d'Ivoire<br/>
                    <span style="color: #888888;">G√©n√©r√© le ${format_datetime(env, context_timestamp(datetime.datetime.now()), dt_format='dd/MM/yyyy √† HH:mm')}</span>
                </span>
            </td>
        </tr>
    </table>
</div>
            </field>
            <field name="lang">${object.customer_id.lang}</field>
            <field name="auto_delete" eval="True"/>
        </record>
    </data>
</odoo>
