<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Forwarding Agent Tree View -->
    <record id="potting_forwarding_agent_view_tree" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.tree</field>
        <field name="model">potting.forwarding.agent</field>
        <field name="arch" type="xml">
            <tree string="Transitaires" 
                  decoration-muted="not active"
                  decoration-danger="balance_due > 0"
                  multi_edit="1"
                  sample="1">
                <field name="active" column_invisible="1"/>
                <field name="currency_id" column_invisible="1"/>
                <field name="code" decoration-bf="1" string="Code"/>
                <field name="name" decoration-bf="1" string="Nom du transitaire"/>
                <field name="phone" widget="phone" optional="show"/>
                <field name="email" widget="email" optional="show"/>
                <field name="transit_order_count" string="Total OT"
                       decoration-info="transit_order_count > 0"/>
                <field name="active_transit_order_count" string="OT Actifs"
                       decoration-success="active_transit_order_count > 0"
                       decoration-bf="1"/>
                <field name="total_invoiced" widget="monetary" string="Factur√©"
                       sum="Total Factur√©" optional="show"/>
                <field name="total_paid" widget="monetary" string="Pay√©"
                       sum="Total Pay√©" 
                       decoration-success="total_paid > 0"/>
                <field name="balance_due" widget="monetary" string="Solde d√ª"
                       sum="Total D√ª"
                       decoration-danger="balance_due > 0"
                       decoration-success="balance_due &lt;= 0"
                       decoration-bf="1"/>
                <field name="payment_progress" widget="progressbar" string="R√®glement"/>
            </tree>
        </field>
    </record>

    <!-- Forwarding Agent Form View -->
    <record id="potting_forwarding_agent_view_form" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.form</field>
        <field name="model">potting.forwarding.agent</field>
        <field name="arch" type="xml">
            <form string="Transitaire">
                <field name="active" invisible="1"/>
                <field name="currency_id" invisible="1"/>
                <header>
                    <button name="action_create_payment_request" 
                            type="object" 
                            string="üí≥ Cr√©er un paiement" 
                            class="btn-primary"
                            invisible="balance_due &lt;= 0"/>
                    <button name="action_view_transit_orders" 
                            type="object" 
                            string="üì¶ Voir les OT" 
                            class="btn-secondary"
                            invisible="transit_order_count == 0"/>
                </header>
                <sheet>
                    <!-- Alerte solde d√ª -->
                    <div class="alert alert-danger mb-3" role="alert" 
                         invisible="balance_due &lt;= 0">
                        <i class="fa fa-exclamation-triangle"/> 
                        <strong>Solde impay√© :</strong> 
                        <field name="balance_due" class="fw-bold"/> FCFA √† r√©gler.
                        <button name="action_create_payment_request" type="object" 
                                class="btn btn-sm btn-danger ms-3" string="Cr√©er paiement"/>
                    </div>
                    <div class="alert alert-success mb-3" role="alert" 
                         invisible="balance_due > 0 or total_invoiced == 0">
                        <i class="fa fa-check-circle"/> 
                        <strong>Compte sold√©</strong> - Tous les paiements sont √† jour.
                    </div>
                    
                    <field name="has_amount_to_refund" invisible="1"/>
                    
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_transit_orders" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-truck">
                            <div class="o_stat_info">
                                <field name="transit_order_count" class="o_stat_value"/>
                                <span class="o_stat_text">Ordres Transit</span>
                            </div>
                        </button>
                        <button name="action_view_invoices" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-file-text-o">
                            <div class="o_stat_info">
                                <field name="invoice_count" class="o_stat_value"/>
                                <span class="o_stat_text">Factures</span>
                            </div>
                        </button>
                        <button name="action_view_transit_orders" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-refresh"
                                context="{'search_default_active_ot': 1}">
                            <div class="o_stat_info">
                                <field name="active_transit_order_count" class="o_stat_value text-success"/>
                                <span class="o_stat_text">OT Actifs</span>
                            </div>
                        </button>
                        <button name="action_view_payments" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-credit-card">
                            <div class="o_stat_info">
                                <span class="o_stat_text">Historique</span>
                                <span class="o_stat_text">Paiements</span>
                            </div>
                        </button>
                        <button class="oe_stat_button" icon="fa-pie-chart" disabled="1"
                                invisible="total_invoiced == 0">
                            <div class="o_stat_info">
                                <field name="payment_progress" class="o_stat_value" widget="statinfo"/>
                                <span class="o_stat_text">% R√©gl√©</span>
                            </div>
                        </button>
                    </div>
                    <widget name="web_ribbon" title="Archiv√©" bg_color="bg-danger" invisible="active"/>
                    <div class="oe_title">
                        <label for="code" class="oe_edit_only"/>
                        <h1>
                            <field name="code" placeholder="Code transitaire" class="text-primary"/>
                        </h1>
                        <label for="partner_id" class="oe_edit_only"/>
                        <h2>
                            <field name="partner_id" placeholder="Partenaire associ√©" 
                                   options="{'no_create': True, 'no_open': True}"/>
                        </h2>
                    </div>
                    
                    <group col="2">
                        <group string="üìû Contact">
                            <field name="phone" widget="phone" placeholder="+225 XX XX XX XX XX"/>
                            <field name="email" widget="email" placeholder="contact@transitaire.com"/>
                            <field name="address" placeholder="Adresse compl√®te..." readonly="1"/>
                        </group>
                        <group string="‚öôÔ∏è Configuration">
                            <field name="default_bank_account_id" 
                                   placeholder="Compte bancaire par d√©faut"
                                   options="{'no_create': True}"/>
                            <label for="commission_rate"/>
                            <div class="o_row">
                                <field name="commission_rate" class="oe_inline"/>
                                <span class="text-muted">%</span>
                            </div>
                            <field name="fixed_fee_per_container" widget="monetary"
                                   string="Frais fixe / conteneur"/>
                            <field name="currency_id" groups="base.group_multi_currency"/>
                        </group>
                    </group>
                    
                    <!-- Alerte montant √† reverser -->
                    <div class="alert alert-warning mb-3" role="alert" 
                         invisible="not has_amount_to_refund">
                        <i class="fa fa-exchange"/> 
                        <strong>Montant √† reverser par le transitaire :</strong> 
                        <field name="amount_to_refund" class="fw-bold"/> FCFA
                        <p class="mb-0 mt-2 small text-muted">
                            Ce montant correspond √† un trop-per√ßu (avances ou paiements exc√©dentaires).
                        </p>
                    </div>
                    
                    <!-- Dashboard financier -->
                    <group string="üí∞ Tableau de bord financier" col="4">
                        <div class="o_kanban_primary_bottom" colspan="4">
                            <field name="payment_progress" widget="progressbar" 
                                   options="{'editable': false}" class="w-100 mb-2"/>
                        </div>
                        <group>
                            <field name="total_invoiced" widget="monetary" 
                                   string="Total factur√©" class="text-info" readonly="1"/>
                        </group>
                        <group>
                            <field name="total_advances" widget="monetary" 
                                   string="Avances vers√©es" class="text-warning" readonly="1"/>
                        </group>
                        <group>
                            <field name="total_paid" widget="monetary" 
                                   string="Total pay√©" class="text-success fw-bold" readonly="1"/>
                        </group>
                        <group>
                            <field name="balance_due" widget="monetary" 
                                   string="Reste √† payer"
                                   decoration-danger="balance_due > 0"
                                   decoration-success="balance_due &lt;= 0"
                                   class="fw-bold fs-5" readonly="1"/>
                        </group>
                    </group>
                    
                    <!-- Section factures -->
                    <group string="üìÑ Factures transitaire" col="4" invisible="invoice_count == 0">
                        <group>
                            <field name="invoice_count" readonly="1" string="Total factures"/>
                        </group>
                        <group>
                            <field name="total_invoice_amount" widget="monetary" readonly="1" string="Montant total"/>
                        </group>
                        <group>
                            <field name="pending_invoice_count" readonly="1" string="En attente paiement"
                                   decoration-warning="pending_invoice_count > 0"/>
                        </group>
                        <group>
                            <field name="total_pending_invoice_amount" widget="monetary" readonly="1" 
                                   string="Montant en attente"
                                   decoration-danger="total_pending_invoice_amount > 0"
                                   class="fw-bold"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="üìÑ Factures" name="invoices">
                            <field name="invoice_ids" readonly="1">
                                <tree string="Factures transitaire" decoration-success="state == 'paid'"
                                      decoration-warning="state == 'validated'"
                                      decoration-info="state == 'submitted'">
                                    <field name="name"/>
                                    <field name="invoice_number"/>
                                    <field name="invoice_date"/>
                                    <field name="amount_total" sum="Total"/>
                                    <field name="state" widget="badge"/>
                                </tree>
                            </field>
                            <div class="text-end mt-2">
                                <button name="action_view_invoices" type="object" 
                                        string="üìÑ Voir toutes les factures" class="btn-link"/>
                            </div>
                        </page>
                        <page string="üí≥ Paiements" name="payments">
                            <field name="payment_line_ids">
                                <tree editable="bottom" create="1">
                                    <field name="name" readonly="1"/>
                                    <field name="payment_type"/>
                                    <field name="payment_date"/>
                                    <field name="amount"/>
                                    <field name="payment_method"/>
                                    <field name="reference"/>
                                    <field name="state" widget="badge" 
                                           decoration-success="state == 'confirmed'"
                                           decoration-warning="state == 'pending'"
                                           decoration-muted="state == 'cancelled'"/>
                                    <field name="payment_request_id" optional="hide"/>
                                </tree>
                            </field>
                        </page>
                        <page string="üè¶ Comptes Bancaires" name="banks">
                            <field name="bank_account_ids">
                                <tree>
                                    <field name="bank_id"/>
                                    <field name="acc_number"/>
                                </tree>
                            </field>
                        </page>
                        <page string="üìù Notes" name="notes">
                            <field name="notes" placeholder="Notes..."/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Forwarding Agent Kanban View -->
    <record id="potting_forwarding_agent_view_kanban" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.kanban</field>
        <field name="model">potting.forwarding.agent</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" sample="1">
                <field name="name"/>
                <field name="code"/>
                <field name="phone"/>
                <field name="email"/>
                <field name="active"/>
                <field name="balance_due"/>
                <field name="total_invoiced"/>
                <field name="total_paid"/>
                <field name="transit_order_count"/>
                <field name="active_transit_order_count"/>
                <field name="payment_progress"/>
                <field name="currency_id"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <!-- En-t√™te avec badge statut -->
                                <div class="o_kanban_record_top mb-2">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title fs-5">
                                            <i class="fa fa-building-o text-primary me-1"/>
                                            <field name="name"/>
                                        </strong>
                                    </div>
                                    <span class="badge bg-primary">
                                        <field name="code"/>
                                    </span>
                                </div>
                                
                                <!-- Corps avec informations -->
                                <div class="o_kanban_record_body">
                                    <div t-if="record.phone.raw_value" class="mb-1 text-muted small">
                                        <i class="fa fa-phone"/> <field name="phone"/>
                                    </div>
                                    <div t-if="record.email.raw_value" class="mb-1 text-muted small">
                                        <i class="fa fa-envelope"/> <field name="email"/>
                                    </div>
                                    <hr class="my-2"/>
                                    <!-- Stats OT -->
                                    <div class="d-flex justify-content-between mb-2">
                                        <span class="badge bg-info">
                                            <i class="fa fa-truck"/> 
                                            <field name="transit_order_count"/> OT total
                                        </span>
                                        <span class="badge bg-success" t-if="record.active_transit_order_count.raw_value > 0">
                                            <i class="fa fa-refresh"/> 
                                            <field name="active_transit_order_count"/> actifs
                                        </span>
                                    </div>
                                    <!-- Progression paiements -->
                                    <div class="mb-2" t-if="record.total_invoiced.raw_value > 0">
                                        <div class="text-muted small mb-1">R√®glement</div>
                                        <field name="payment_progress" widget="progressbar" 
                                               options="{'editable': false}"/>
                                    </div>
                                </div>
                                
                                <!-- Footer avec solde -->
                                <div class="o_kanban_record_bottom mt-2 pt-2 border-top">
                                    <div class="oe_kanban_bottom_left">
                                        <span t-if="record.balance_due.raw_value > 0" 
                                              class="text-danger fw-bold">
                                            <i class="fa fa-exclamation-circle"/> 
                                            D√ª: <field name="balance_due" widget="monetary"/>
                                        </span>
                                        <span t-elif="record.total_invoiced.raw_value > 0" 
                                              class="text-success fw-bold">
                                            <i class="fa fa-check-circle"/> Sold√©
                                        </span>
                                        <span t-else="" class="text-muted">
                                            <i class="fa fa-minus-circle"/> Aucune transaction
                                        </span>
                                    </div>
                                    <div class="oe_kanban_bottom_right" t-if="!record.active.raw_value">
                                        <span class="badge bg-secondary">Archiv√©</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Forwarding Agent Search View -->
    <record id="potting_forwarding_agent_view_search" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.search</field>
        <field name="model">potting.forwarding.agent</field>
        <field name="arch" type="xml">
            <search string="Transitaires">
                <field name="name"/>
                <field name="code"/>
                <field name="partner_id"/>
                <filter name="has_balance" string="Avec solde" domain="[('balance_due', '>', 0)]"/>
                <filter name="no_balance" string="Sold√©" domain="[('balance_due', '&lt;=', 0)]"/>
                <separator/>
                <filter name="active_ot" string="Avec OT actifs" domain="[('active_transit_order_count', '>', 0)]"/>
                <separator/>
                <filter name="inactive" string="Archiv√©s" domain="[('active', '=', False)]"/>
                <group expand="0" string="Grouper par">
                    <filter name="group_company" string="Soci√©t√©" context="{'group_by': 'company_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Forwarding Agent Action -->
    <record id="potting_forwarding_agent_action" model="ir.actions.act_window">
        <field name="name">Transitaires</field>
        <field name="res_model">potting.forwarding.agent</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="context">{'search_default_has_balance': 0}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Cr√©er un nouveau transitaire
            </p>
            <p>
                Les transitaires s'occupent des op√©rations d'exportation.
                Vous pouvez suivre leurs paiements et les OT associ√©s.
            </p>
        </field>
    </record>

    <!-- Forwarding Agent Payment Tree View -->
    <record id="potting_forwarding_agent_payment_view_tree" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.payment.tree</field>
        <field name="model">potting.forwarding.agent.payment</field>
        <field name="arch" type="xml">
            <tree string="Paiements Transitaires"
                  decoration-success="state == 'confirmed'"
                  decoration-warning="state == 'pending'"
                  decoration-muted="state == 'cancelled'"
                  default_order="payment_date desc"
                  multi_edit="1"
                  sample="1">
                <header>
                    <button name="action_confirm" type="object" string="Confirmer" class="btn-primary"/>
                </header>
                <field name="currency_id" column_invisible="1"/>
                <field name="name" decoration-bf="1" string="R√©f√©rence"/>
                <field name="forwarding_agent_id" string="Transitaire"/>
                <field name="transit_order_id" optional="show" string="OT li√©"/>
                <field name="payment_type" widget="badge"
                       decoration-info="payment_type == 'advance'"
                       decoration-success="payment_type == 'balance'"
                       decoration-primary="payment_type == 'commission'"/>
                <field name="payment_date" widget="date" string="Date"/>
                <field name="amount" sum="Total" widget="monetary" 
                       decoration-bf="1" class="text-success"/>
                <field name="payment_method" optional="show"
                       widget="badge"/>
                <field name="reference" optional="show" string="R√©f. externe"/>
                <field name="payment_request_id" optional="hide" string="Demande li√©e"/>
                <field name="confirmed_by_id" optional="hide" string="Confirm√© par"/>
                <field name="confirmed_date" optional="hide" string="Date confirmation"/>
                <field name="state" widget="badge" 
                       decoration-success="state == 'confirmed'"
                       decoration-warning="state == 'pending'"
                       decoration-info="state == 'draft'"
                       decoration-muted="state == 'cancelled'"/>
            </tree>
        </field>
    </record>

    <!-- Forwarding Agent Payment Form View -->
    <record id="potting_forwarding_agent_payment_view_form" model="ir.ui.view">
        <field name="name">potting.forwarding.agent.payment.form</field>
        <field name="model">potting.forwarding.agent.payment</field>
        <field name="arch" type="xml">
            <form string="Paiement Transitaire">
                <header>
                    <button name="action_confirm" 
                            type="object" 
                            string="‚úÖ Confirmer le paiement" 
                            class="btn-primary"
                            invisible="state != 'draft'"
                            confirm="Confirmez-vous ce paiement ? Cette action est irr√©versible."/>
                    <button name="action_create_payment_request" 
                            type="object" 
                            string="üìã Cr√©er demande de paiement" 
                            class="btn-info"
                            invisible="state != 'draft' or payment_request_id"/>
                    <button name="action_cancel" 
                            type="object" 
                            string="‚ùå Annuler"
                            invisible="state in ('confirmed', 'cancelled')"
                            confirm="Voulez-vous vraiment annuler ce paiement ?"/>
                    <button name="action_draft" 
                            type="object" 
                            string="‚Ü©Ô∏è Remettre en brouillon"
                            invisible="state != 'cancelled'"
                            groups="potting_management.group_potting_manager"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,pending,confirmed"/>
                </header>
                <sheet>
                    <!-- Alertes contextuelles -->
                    <div class="alert alert-info mb-3" role="alert" 
                         invisible="state != 'draft'">
                        <i class="fa fa-info-circle"/> 
                        <strong>Brouillon</strong> - Ce paiement n'est pas encore confirm√©.
                    </div>
                    <div class="alert alert-warning mb-3" role="alert" 
                         invisible="state != 'pending'">
                        <i class="fa fa-clock-o"/> 
                        <strong>En attente</strong> - Paiement en cours de traitement.
                    </div>
                    <div class="alert alert-success mb-3" role="alert" 
                         invisible="state != 'confirmed'">
                        <i class="fa fa-check-circle"/> 
                        <strong>Confirm√©</strong> - Paiement valid√© le 
                        <field name="confirmed_date" class="fw-bold"/> par 
                        <field name="confirmed_by_id" class="fw-bold"/>.
                    </div>
                    
                    <widget name="web_ribbon" title="Confirm√©" bg_color="bg-success" 
                            invisible="state != 'confirmed'"/>
                    <widget name="web_ribbon" title="Annul√©" bg_color="bg-secondary" 
                            invisible="state != 'cancelled'"/>
                    
                    <div class="oe_title">
                        <label for="name"/>
                        <h1>
                            <field name="name" readonly="1" class="text-primary"/>
                        </h1>
                    </div>
                    
                    <group col="2">
                        <group string="üè¢ Transitaire">
                            <field name="forwarding_agent_id" 
                                   readonly="state != 'draft'"
                                   options="{'no_create': True, 'no_open': False}"/>
                            <field name="transit_order_id" 
                                   readonly="state != 'draft'"
                                   options="{'no_create': True}"/>
                        </group>
                        <group string="üí∞ D√©tails du paiement">
                            <field name="payment_type" readonly="state != 'draft'"
                                   widget="radio" options="{'horizontal': true}"/>
                            <field name="amount" readonly="state != 'draft'"
                                   class="fw-bold fs-4 text-success"/>
                            <field name="currency_id" invisible="1"/>
                            <field name="payment_date" readonly="state != 'draft'"/>
                            <field name="payment_method" readonly="state != 'draft'"
                                   widget="selection"/>
                            <field name="reference" readonly="state != 'draft'"
                                   placeholder="N¬∞ de transaction, r√©f√©rence..."/>
                        </group>
                    </group>
                    
                    <group col="2">
                        <group string="üìã Lien demande de paiement">
                            <field name="payment_request_id" readonly="1"
                                   options="{'no_create': True}"/>
                            <field name="check_id" readonly="1"
                                   invisible="payment_method != 'check'"
                                   string="Ch√®que √©mis"/>
                            <field name="transfer_id" readonly="1"
                                   invisible="payment_method != 'bank_transfer'"
                                   string="Virement √©mis"/>
                        </group>
                        <group string="‚úÖ Confirmation" invisible="state == 'draft'">
                            <field name="confirmed_by_id" readonly="1"/>
                            <field name="confirmed_date" readonly="1"/>
                        </group>
                    </group>
                    
                    <group string="üìù Notes">
                        <field name="notes" nolabel="1" 
                               placeholder="Remarques, justificatifs, d√©tails suppl√©mentaires..."
                               readonly="state == 'confirmed'"/>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Forwarding Agent Payment Action -->
    <record id="potting_forwarding_agent_payment_action" model="ir.actions.act_window">
        <field name="name">Paiements Transitaires</field>
        <field name="res_model">potting.forwarding.agent.payment</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{}</field>
    </record>

    <!-- Create Forwarding Payment Wizard View -->
    <record id="potting_create_forwarding_payment_wizard_view_form" model="ir.ui.view">
        <field name="name">potting.create.forwarding.payment.wizard.form</field>
        <field name="model">potting.create.forwarding.payment.wizard</field>
        <field name="arch" type="xml">
            <form string="Cr√©er un Paiement Transitaire">
                <sheet>
                    <group>
                        <group string="Transitaire">
                            <field name="forwarding_agent_id" readonly="1"/>
                            <field name="partner_id" readonly="1"/>
                            <field name="balance_due"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                        <group string="Facture Transitaire">
                            <field name="invoice_id" 
                                   options="{'no_create': True}"
                                   required="create_payment_request"/>
                            <field name="invoice_amount" readonly="1"
                                   invisible="not invoice_id"/>
                            <field name="invoice_state" invisible="1"/>
                        </group>
                    </group>
                    
                    <group>
                        <group string="Paiement">
                            <field name="payment_type"/>
                            <field name="amount"/>
                            <field name="payment_method" widget="radio" 
                                   options="{'horizontal': true}"/>
                            <field name="expected_payment_date"/>
                        </group>
                        <group string="Ordres de Transit">
                            <field name="transit_order_ids" widget="many2many_tags"
                                   options="{'no_create': True}"/>
                        </group>
                    </group>
                    
                    <!-- Champs pour paiement par ch√®que -->
                    <group string="Informations Ch√®que" 
                           invisible="payment_method != 'check'">
                        <group>
                            <field name="bank_id" 
                                   required="payment_method == 'check' and create_payment_request"
                                   options="{'no_create': True}"/>
                            <field name="bank_account_id"
                                   required="payment_method == 'check' and create_payment_request"
                                   options="{'no_create': True}"/>
                        </group>
                        <group>
                            <field name="check_number"
                                   required="payment_method == 'check' and create_payment_request"
                                   placeholder="Ex: 0012345"/>
                            <field name="check_date"/>
                        </group>
                    </group>
                    
                    <separator string="Demande de Paiement"/>
                    
                    <group>
                        <group>
                            <field name="create_payment_request"/>
                            <field name="existing_payment_request_id" 
                                   invisible="create_payment_request"
                                   options="{'no_create': True}"/>
                            <field name="subject" 
                                   invisible="not create_payment_request or existing_payment_request_id"/>
                        </group>
                    </group>
                    
                    <group>
                        <field name="notes" placeholder="Notes ou commentaires..."/>
                    </group>
                </sheet>
                
                <footer>
                    <button name="action_create_payment" 
                            type="object" 
                            string="Cr√©er le paiement" 
                            class="btn-primary"/>
                    <button string="Annuler" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
</odoo>
