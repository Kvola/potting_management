<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ================================================================== -->
    <!-- WIZARD: Ajouter une production - Vue Form am√©lior√©e -->
    <!-- ================================================================== -->
    <record id="potting_add_production_wizard_view_form" model="ir.ui.view">
        <field name="name">potting.add.production.wizard.form</field>
        <field name="model">potting.add.production.wizard</field>
        <field name="arch" type="xml">
            <form string="Nouvelle Production">
                <sheet>
                    <!-- Header avec titre stylis√© -->
                    <div class="oe_title mb-3">
                        <h2>
                            <span class="badge bg-primary" style="font-size: 1.2em;">
                                üè≠ Ajouter une Production
                            </span>
                        </h2>
                    </div>

                    <!-- Message d'avertissement -->
                    <div class="alert alert-warning mb-3" role="alert" invisible="not warning_message">
                        <field name="warning_message" nolabel="1"/>
                    </div>

                    <!-- Alerte de d√©passement de capacit√© -->
                    <div class="alert alert-danger mb-3" role="alert" invisible="not will_exceed_capacity">
                        <strong>‚õî Attention!</strong> Cette production d√©passerait la capacit√© maximale du lot (110%).
                    </div>

                    <group>
                        <!-- Colonne gauche: S√©lection et saisie -->
                        <group string="üìã Informations de production" col="2">
                            <field name="lot_id" 
                                   options="{'no_create': True, 'no_open': True}"
                                   placeholder="S√©lectionnez un lot disponible..."
                                   class="fw-bold"/>
                            
                            <field name="date" class="fw-bold"/>
                            
                            <label for="units_produced" string="Unit√©s √† produire"/>
                            <div class="d-flex align-items-center">
                                <field name="units_produced" class="fw-bold text-primary" style="max-width: 100px;"/>
                                <span class="ms-2 text-muted">
                                    <field name="packaging_unit_name" readonly="1" nolabel="1"/>
                                </span>
                            </div>
                            
                            <field name="shift" widget="radio" options="{'horizontal': true}"/>
                            
                            <field name="operator_id" options="{'no_create': True}"/>
                        </group>

                        <!-- Colonne droite: Informations calcul√©es -->
                        <group string="üìä Aper√ßu de la production">
                            <field name="product_type_display" readonly="1" string="Type de produit"/>
                            
                            <label for="production_tonnage" string="Tonnage ajout√©"/>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-info fs-6 me-2">
                                    <field name="production_tonnage" readonly="1" nolabel="1"/> T
                                </span>
                                <span class="text-muted">
                                    (<field name="production_tonnage_kg" readonly="1" nolabel="1"/> kg)
                                </span>
                            </div>
                            
                            <field name="new_fill_percentage" readonly="1" string="Remplissage apr√®s" widget="progressbar" 
                                   options="{'max_value': 110, 'editable': false}"/>
                            
                            <field name="remaining_units" readonly="1" string="Unit√©s restantes sur le lot"
                                   invisible="not lot_id"/>
                        </group>
                    </group>

                    <!-- Informations d√©taill√©es du lot -->
                    <group string="‚ÑπÔ∏è D√©tails du lot s√©lectionn√©" invisible="not lot_id">
                        <field name="lot_info_html" nolabel="1" colspan="2" readonly="1"/>
                    </group>

                    <!-- Informations compl√©mentaires -->
                    <group>
                        <group string="üîó R√©f√©rences" invisible="not lot_id">
                            <field name="transit_order_id" readonly="1"/>
                            <field name="customer_order_id" readonly="1"/>
                        </group>
                        <group string="üìù Notes">
                            <field name="note" placeholder="Notes optionnelles sur cette production..." nolabel="1"/>
                        </group>
                    </group>

                    <!-- Champs cach√©s -->
                    <field name="company_id" invisible="1"/>
                    <field name="can_confirm" invisible="1"/>
                    <field name="will_exceed_capacity" invisible="1"/>
                    <field name="packaging_unit_weight" invisible="1"/>
                    <field name="packaging_unit_weight_kg" invisible="1"/>
                    <field name="target_tonnage" invisible="1"/>
                    <field name="current_tonnage" invisible="1"/>
                    <field name="remaining_tonnage" invisible="1"/>
                    <field name="fill_percentage" invisible="1"/>
                    <field name="new_tonnage" invisible="1"/>
                    <field name="product_type" invisible="1"/>
                </sheet>
                <footer>
                    <button name="action_confirm" 
                            string="‚úÖ Confirmer" 
                            type="object" 
                            class="btn-primary"
                            invisible="not can_confirm"/>
                    <button name="action_confirm_and_new" 
                            string="‚úÖ Confirmer et Nouveau" 
                            type="object" 
                            class="btn-secondary"
                            invisible="not can_confirm"/>
                    <button string="Annuler" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action pour ouvrir le wizard -->
    <record id="action_potting_add_production_wizard" model="ir.actions.act_window">
        <field name="name">Ajouter une production</field>
        <field name="res_model">potting.add.production.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{}</field>
    </record>

</odoo>
